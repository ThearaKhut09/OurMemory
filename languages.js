// Language translations for the Our Memory website
const languages = {
    km: {
        // Navigation and Header
        title: "áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸážšáž”ážŸáŸ‹áž™áž¾áž„ - ážšáž¿áž„ážŸáŸ’áž“áŸáž áž¶",
        logoText: "áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸážšáž”ážŸáŸ‹áž™áž¾áž„",
        toggleTheme: "áž”áŸ’ážáž¼ážšáž˜áŸ‰áž¼ážŠáž„áž„áž¹áž",
        language: "áž—áž¶ážŸáž¶",
        
        // Hero Section
        heroTitle1: "ážŠáŸ†ážŽáž¾ážšáž¢ážŸáŸ’áž…áž¶ážšáŸ’áž™",
        heroTitle2: "ážšáž”ážŸáŸ‹áž™áž¾áž„áž‡áž¶áž˜áž½áž™áž‚áŸ’áž“áž¶",
        heroSubtitle: "áž…áž¶áž”áŸ‹áž™áž€ážšáž¶áž›áŸ‹áž–áŸáž›ážœáŸáž›áž¶ážŠáŸáž˜áž¶áž“ážáž˜áŸ’áž›áŸƒáž“áŸƒážšáž¿áž„ážŸáŸ’áž“áŸáž áž¶ážšáž”ážŸáŸ‹áž™áž¾áž„",
        createMemoryButton: "áž”áž„áŸ’áž€áž¾ážáž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸážáŸ’áž˜áž¸",
        
        // Add Memory Section
        addMemoryTitle: "áž”áž“áŸ’ážáŸ‚áž˜áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸážáŸ’áž˜áž¸",
        closeSection: "áž”áž·áž‘áž•áŸ’áž“áŸ‚áž€áž”áž“áŸ’ážáŸ‚áž˜áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸ",
        memoryTitleLabel: "áž…áŸ†ážŽáž„áž‡áž¾áž„áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸ",
        memoryTitlePlaceholder: "áž€áž¶ážšážŽáž¶ážáŸ‹áž‡áž½áž”ážŠáŸ†áž”áž¼áž„, áž€áž¶ážšáž’áŸ’ážœáž¾ážŠáŸ†ážŽáž¾ážš, áŸ”áž›áŸ”",
        descriptionLabel: "áž€áž¶ážšáž–áž·áž–ážŽáŸŒáž“áž¶",
        descriptionPlaceholder: "áž”áŸ’ážšáž¶áž”áŸ‹áž™áž¾áž„áž¢áŸ†áž–áž¸áž–áŸáž›ážœáŸáž›áž¶ážŠáŸážŸáŸ’ážšážŸáŸ‹ážŸáŸ’áž¢áž¶ážáž“áŸáŸ‡...",
        dateLabel: "áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘",
        uploadImageLabel: "áž•áŸ’áž‘áž»áž€áž¡áž¾áž„ážšáž¼áž”áž—áž¶áž–",
        uploadImageText: "áž…áž»áž…ážŠáž¾áž˜áŸ’áž”áž¸áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸ áž¬áž¢áž¼ážŸ áž“áž·áž„áž‘áž˜áŸ’áž›áž¶áž€áŸ‹",
        saveMemoryButton: "ážšáž€áŸ’ážŸáž¶áž‘áž»áž€áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸ",
        
        // Memories Gallery
        memoriesTitle: "áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸážŠáŸážŸáŸ’ážšážŸáŸ‹ážŸáŸ’áž¢áž¶ážážšáž”ážŸáŸ‹áž™áž¾áž„",
        noMemoriesText: "áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸáž“áŸ…áž¡áž¾áž™áž‘áŸáŸ” ážŸáž¼áž˜áž”áž„áŸ’áž€áž¾ážáž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸážŠáŸážŸáŸ’ážšážŸáŸ‹ážŸáŸ’áž¢áž¶ážážŠáŸ†áž”áž¼áž„ážšáž”ážŸáŸ‹áž¢áŸ’áž“áž€áž“áŸ…ážáž¶áž„áž›áž¾! ðŸ’•",
        
        // Modal Actions
        editButton: "áž€áŸ‚áž”áŸ’ážšáŸ‚",
        deleteButton: "áž›áž»áž”",
        cancelButton: "áž”áŸ„áŸ‡áž”áž„áŸ‹",
        saveChangesButton: "ážšáž€áŸ’ážŸáž¶áž‘áž»áž€áž€áž¶ážšáž•áŸ’áž›áž¶ážŸáŸ‹áž”áŸ’ážáž¼ážš",
        
        // Edit Modal
        editMemoryTitle: "áž€áŸ‚áž”áŸ’ážšáŸ‚áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸ",
        changeImageText: "áž•áŸ’áž›áž¶ážŸáŸ‹áž”áŸ’ážáž¼ážšážšáž¼áž”áž—áž¶áž– (áž‡áž˜áŸ’ážšáž¾ážŸ)",
        changeImageSubtext: "áž…áž»áž…ážŠáž¾áž˜áŸ’áž”áž¸áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸážšáž¼áž”áž—áž¶áž–ážáŸ’áž˜áž¸",
        
        // Confirmation Modal
        confirmDeleteTitle: "áž”áž‰áŸ’áž‡áž¶áž€áŸ‹áž€áž¶ážšáž›áž»áž”",
        confirmDeleteMessage: "ážáž¾áž¢áŸ’áž“áž€áž”áŸ’ážšáž¶áž€ážŠážáž¶áž…áž„áŸ‹áž›áž»áž”áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸáž“áŸáŸ‡áž˜áŸ‚áž“áž‘áŸ? ážŸáž€áž˜áŸ’áž˜áž—áž¶áž–áž“áŸáŸ‡áž˜áž·áž“áž¢áž¶áž…ážáŸ’ážšáž¡áž”áŸ‹ážœáž·áž‰áž”áž¶áž“áž‘áŸáŸ”",
        
        // Notifications
        memorySavedTitle: "áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸáž”áž¶áž“ážšáž€áŸ’ážŸáž¶áž‘áž»áž€!",
        memorySavedMessage: "áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸážŠáŸážŸáŸ’ážšážŸáŸ‹ážŸáŸ’áž¢áž¶ážážšáž”ážŸáŸ‹áž¢áŸ’áž“áž€ážáŸ’ážšáž¼ážœáž”áž¶áž“ážšáž€áŸ’ážŸáž¶áž‘áž»áž€ážŠáŸ„áž™áž‡áŸ„áž‚áž‡áŸáž™áŸ”",
        memoryUpdatedTitle: "áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸáž”áž¶áž“áž’áŸ’ážœáž¾áž”áž…áŸ’áž…áž»áž”áŸ’áž”áž“áŸ’áž“áž—áž¶áž–!",
        memoryUpdatedMessage: "áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸážšáž”ážŸáŸ‹áž¢áŸ’áž“áž€ážáŸ’ážšáž¼ážœáž”áž¶áž“áž’áŸ’ážœáž¾áž”áž…áŸ’áž…áž»áž”áŸ’áž”áž“áŸ’áž“áž—áž¶áž–ážŠáŸ„áž™áž‡áŸ„áž‚áž‡áŸáž™áŸ”",
        memoryDeletedTitle: "áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸáž”áž¶áž“áž›áž»áž”!",
        memoryDeletedMessage: "áž¢áž“áž»ážŸáŸ’ážŸáž¶ážœážšáž¸áž™áŸážáŸ’ážšáž¼ážœáž”áž¶áž“áž›áž»áž”ážŠáŸ„áž™áž‡áŸ„áž‚áž‡áŸáž™áŸ”",
        invalidFileTitle: "áž¯áž€ážŸáž¶ážšáž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœ",
        invalidFileMessage: "ážŸáž¼áž˜áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸáž¯áž€ážŸáž¶ážšážšáž¼áž”áž—áž¶áž–ážŠáŸ‚áž›ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáŸ”",
        
        // Sample Memories (Khmer)
        sampleMemories: [
            {
                title: "Lover",
                description: "My favorite person in the world, the one who makes my heart skip a beat every time I see you. Your smile is my sunshine, and your laughter is my favorite melody."
            },
            {
                title: "Weekend Getaway ðŸ–ï¸",
                description: "Our spontaneous trip to the beach, where we watched the sunset together. The warm sand and sharing ice cream while the waves crashed nearby - pure bliss."
            },
            {
                title: "My Pretty",
                description: "My favorite person in the world, the one who makes my heart skip a beat every time I see you. Your smile is my sunshine."
            },
            {
                title: "She so Beautiful ðŸ’",
                description: "Celebrating our special anniversary dinner at our favorite restaurant. The flowers you arranged took my breath away and made the night even more perfect."
            },
            {
                title: "Exploring Together ðŸŒŸ",
                description: "Our exciting adventures in discovering new places together. Every moment with you feels like a new discovery, and I love how we create beautiful memories everywhere we go."
            }
        ]
    },
    en: {
        // Navigation and Header
        title: "Our Memory - Love Stories",
        logoText: "Our Memory",
        toggleTheme: "Toggle dark mode",
        language: "Language",
        
        // Hero Section
        heroTitle1: "Our Beautiful",
        heroTitle2: "Journey Together",
        heroSubtitle: "Capturing every precious moment of our love story",
        createMemoryButton: "Create New Memory",
        
        // Add Memory Section
        addMemoryTitle: "Add a New Memory",
        closeSection: "Close add memory section",
        memoryTitleLabel: "Memory Title",
        memoryTitlePlaceholder: "Our first date, vacation, etc...",
        descriptionLabel: "Description",
        descriptionPlaceholder: "Tell us about this beautiful moment...",
        dateLabel: "Date",
        uploadImageLabel: "Upload Image",
        uploadImageText: "Click to select or drag & drop",
        saveMemoryButton: "Save Memory",
        
        // Memories Gallery
        memoriesTitle: "Our Beautiful Memories",
        noMemoriesText: "No memories yet. Create your first beautiful memory above! ðŸ’•",
        
        // Modal Actions
        editButton: "Edit",
        deleteButton: "Delete",
        cancelButton: "Cancel",
        saveChangesButton: "Save Changes",
        
        // Edit Modal
        editMemoryTitle: "Edit Memory",
        changeImageText: "Change Image (Optional)",
        changeImageSubtext: "Click to select new image",
        
        // Confirmation Modal
        confirmDeleteTitle: "Confirm Delete",
        confirmDeleteMessage: "Are you sure you want to delete this memory? This action cannot be undone.",
        
        // Notifications
        memorySavedTitle: "Memory Saved!",
        memorySavedMessage: "Your beautiful memory has been saved successfully.",
        memoryUpdatedTitle: "Memory Updated!",
        memoryUpdatedMessage: "Your memory has been successfully updated.",
        memoryDeletedTitle: "Memory Deleted!",
        memoryDeletedMessage: "The memory has been successfully deleted.",
        invalidFileTitle: "Invalid File",
        invalidFileMessage: "Please select a valid image file.",
        
        // Sample Memories (English)
        sampleMemories: [
            {
                title: "Lover",
                description: "My favorite person in the world, the one who makes my heart skip a beat every time I see you. Your smile is my sunshine, and your laughter is my favorite melody."
            },
            {
                title: "Weekend Getaway ðŸ–ï¸",
                description: "Our spontaneous trip to the beach, where we watched the sunset together. The warm sand and sharing ice cream while the waves crashed nearby - pure bliss."
            },
            {
                title: "My Pretty",
                description: "My favorite person in the world, the one who makes my heart skip a beat every time I see you. Your smile is my sunshine."
            },
            {
                title: "She so Beautiful ðŸ’",
                description: "Celebrating our special anniversary dinner at our favorite restaurant. The flowers you arranged took my breath away and made the night even more perfect."
            },
            {
                title: "Exploring Together ðŸŒŸ",
                description: "Our exciting adventures in discovering new places together. Every moment with you feels like a new discovery, and I love how we create beautiful memories everywhere we go."
            }
        ]
    }
};

// Current language (default: Khmer)
let currentLanguage = 'km';

// Get text based on current language
function getText(key) {
    return languages[currentLanguage][key] || languages['en'][key] || key;
}

// Get sample memories based on current language
function getSampleMemories() {
    return languages[currentLanguage].sampleMemories || languages['en'].sampleMemories;
}

// Change language function
function changeLanguage(langCode) {
    if (languages[langCode]) {
        currentLanguage = langCode;
        localStorage.setItem('selectedLanguage', langCode);
        
        // Set lang attribute on html element for better font support
        document.documentElement.setAttribute('lang', langCode);
        
        updatePageLanguage();
        
        // Trigger custom event for language change
        const event = new CustomEvent('languageChanged', { 
            detail: { language: langCode },
            bubbles: true
        });
        window.dispatchEvent(event);
        
        // Update language selector UI
        const langOptions = document.querySelectorAll('.lang-option');
        langOptions.forEach(option => {
            option.classList.remove('active');
            if (option.dataset.lang === langCode) {
                option.classList.add('active');
            }
        });
        
        // Refresh memories with new language if they are sample memories
        const stored = localStorage.getItem('ourMemories');
        if (!stored || JSON.parse(stored).length === 0) {
            if (typeof loadSampleMemories === 'function') {
                loadSampleMemories();
            }
        }
        
        if (typeof displayMemories === 'function') {
            displayMemories();
        }
    }
}

// Update all text on the page
function updatePageLanguage() {
    // Update document title
    document.title = getText('title');
    
    // Update logo text
    const logoText = document.querySelector('.logo span');
    if (logoText) logoText.textContent = getText('logoText');
    
    // Update theme toggle aria-label
    const themeToggle = document.getElementById('theme-toggle');
    if (themeToggle) themeToggle.setAttribute('aria-label', getText('toggleTheme'));
    
    // Update language selector text
    const langText = document.querySelector('.language-selector .lang-text');
    if (langText) langText.textContent = getText('language');
    
    // Update hero section
    const heroTitle1 = document.querySelector('.romantic-text');
    const heroTitle2 = document.querySelector('.memory-text');
    const heroSubtitle = document.querySelector('.hero-subtitle');
    const ctaButton = document.querySelector('.cta-button');
    
    if (heroTitle1) heroTitle1.textContent = getText('heroTitle1');
    if (heroTitle2) heroTitle2.textContent = getText('heroTitle2');
    if (heroSubtitle) heroSubtitle.textContent = getText('heroSubtitle');
    if (ctaButton) {
        ctaButton.innerHTML = `
            <i class="fas fa-plus"></i>
            ${getText('createMemoryButton')}
        `;
    }
    
    // Update add memory section
    const addMemoryTitle = document.querySelector('#add-memory .section-title');
    const closeSectionBtn = document.querySelector('.close-section-btn');
    
    if (addMemoryTitle) addMemoryTitle.textContent = getText('addMemoryTitle');
    if (closeSectionBtn) closeSectionBtn.setAttribute('aria-label', getText('closeSection'));
    
    // Update form labels and placeholders
    const memoryTitleLabel = document.querySelector('label[for="memory-title"]');
    const memoryTitleInput = document.getElementById('memory-title');
    const descriptionLabel = document.querySelector('label[for="memory-description"]');
    const descriptionTextarea = document.getElementById('memory-description');
    const dateLabel = document.querySelector('label[for="memory-date"]');
    const uploadLabel = document.querySelector('.file-upload-label span');
    const uploadSubtext = document.querySelector('.file-upload-label small');
    const saveButton = document.querySelector('.submit-btn');
    
    if (memoryTitleLabel) memoryTitleLabel.textContent = getText('memoryTitleLabel');
    if (memoryTitleInput) memoryTitleInput.placeholder = getText('memoryTitlePlaceholder');
    if (descriptionLabel) descriptionLabel.textContent = getText('descriptionLabel');
    if (descriptionTextarea) descriptionTextarea.placeholder = getText('descriptionPlaceholder');
    if (dateLabel) dateLabel.textContent = getText('dateLabel');
    if (uploadLabel) uploadLabel.textContent = getText('uploadImageText');
    if (uploadSubtext) uploadSubtext.textContent = getText('uploadImageText');
    if (saveButton) {
        saveButton.innerHTML = `
            <i class="fas fa-heart"></i>
            ${getText('saveMemoryButton')}
        `;
    }
    
    // Update memories section title
    const memoriesTitle = document.querySelector('#memories .section-title');
    if (memoriesTitle) memoriesTitle.textContent = getText('memoriesTitle');
    
    // Update modal action buttons
    const editBtn = document.querySelector('.edit-btn');
    const deleteBtn = document.querySelector('.delete-btn');
    
    if (editBtn) {
        editBtn.innerHTML = `
            <i class="fas fa-edit"></i>
            ${getText('editButton')}
        `;
    }
    if (deleteBtn) {
        deleteBtn.innerHTML = `
            <i class="fas fa-trash"></i>
            ${getText('deleteButton')}
        `;
    }
    
    // Update edit modal
    const editModalTitle = document.querySelector('#edit-modal .modal-header h2');
    const editImageLabel = document.querySelector('label[for="edit-image"] span');
    const editImageSubtext = document.querySelector('label[for="edit-image"] small');
    const cancelBtn = document.querySelector('.cancel-btn');
    const saveBtn = document.querySelector('.save-btn');
    
    if (editModalTitle) {
        editModalTitle.innerHTML = `
            <i class="fas fa-edit"></i> ${getText('editMemoryTitle')}
        `;
    }
    if (editImageLabel) editImageLabel.textContent = getText('changeImageText');
    if (editImageSubtext) editImageSubtext.textContent = getText('changeImageSubtext');
    if (cancelBtn) {
        cancelBtn.innerHTML = `
            <i class="fas fa-times"></i>
            ${getText('cancelButton')}
        `;
    }
    if (saveBtn) {
        saveBtn.innerHTML = `
            <i class="fas fa-save"></i>
            ${getText('saveChangesButton')}
        `;
    }
    
    // Update edit form labels
    const editTitleLabel = document.querySelector('label[for="edit-title"]');
    const editDescriptionLabel = document.querySelector('label[for="edit-description"]');
    const editDateLabel = document.querySelector('label[for="edit-date"]');
    
    if (editTitleLabel) editTitleLabel.textContent = getText('memoryTitleLabel');
    if (editDescriptionLabel) editDescriptionLabel.textContent = getText('descriptionLabel');
    if (editDateLabel) editDateLabel.textContent = getText('dateLabel');
    
    // Update confirmation modal
    const confirmTitle = document.querySelector('#confirm-modal .confirm-header h3');
    const confirmMessage = document.querySelector('#confirm-modal .confirm-body p');
    const confirmCancelBtn = document.querySelector('#confirm-modal .cancel-btn');
    const confirmDeleteBtn = document.querySelector('.delete-confirm-btn');
    
    if (confirmTitle) confirmTitle.textContent = getText('confirmDeleteTitle');
    if (confirmMessage) confirmMessage.textContent = getText('confirmDeleteMessage');
    if (confirmCancelBtn) {
        confirmCancelBtn.innerHTML = `
            <i class="fas fa-times"></i>
            ${getText('cancelButton')}
        `;
    }
    if (confirmDeleteBtn) {
        confirmDeleteBtn.innerHTML = `
            <i class="fas fa-trash"></i>
            ${getText('deleteButton')}
        `;
    }
}

// Load saved language preference
function loadLanguagePreference() {
    const saved = localStorage.getItem('selectedLanguage');
    if (saved && languages[saved]) {
        currentLanguage = saved;
    }
    
    // Set lang attribute on html element
    document.documentElement.setAttribute('lang', currentLanguage);
    
    updatePageLanguage();
}

// Initialize language system
document.addEventListener('DOMContentLoaded', function() {
    loadLanguagePreference();
});
